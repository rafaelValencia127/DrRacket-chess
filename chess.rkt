#lang racket
(require graphics/graphics)
(open-graphics)
(define proyecto( open-viewport "Ajedrez" 600 600))
((draw-rectangle proyecto)(make-posn 59 59) 482 482)

(define (mapa fila colum bandera-mapa)
  (if (= bandera-mapa 0)
      (begin
        (((draw-pixmap-posn "images/pared-de-ladrillo.gif" 'gif/mask) proyecto )(make-posn 0 0))
        ((draw-solid-rectangle proyecto)(make-posn  120 20) 360 30 "white")
        (mapa fila colum 1)
        )
      (if(<= fila 8)
         (if (odd? fila)
             (if (<= colum 8)
                 (if (even? colum)
                     (begin
                       ((draw-solid-rectangle proyecto)(make-posn (* colum 60)(* fila 60)) 60 60 "black")
                       (mapa fila (+ colum 1) 1)
                       )
                     (begin
                       ((draw-solid-rectangle proyecto)(make-posn (* colum 60)(* fila 60)) 60 60 "white")
                       (mapa fila (+ colum 1) 1)
                       )
                     )
                 (mapa (+ fila 1) 1 1)
                 )
             (if (<= colum 8)
                 (if(odd? colum)
                    (begin
                      ((draw-solid-rectangle proyecto)(make-posn (* colum 60)(* fila 60)) 60 60 "black")
                      (mapa fila (+ colum 1) 1)
                      )
                    (begin
                      ((draw-solid-rectangle proyecto)(make-posn (* colum 60)(* fila 60)) 60 60 "white")
                      (mapa fila (+ colum 1) 1)
                      )
                    )
                 (mapa (+ fila 1) 1 1)
                 )
             )
         (void)
         )
      )
  )

(mapa 1 1 0) 
(((draw-pixmap-posn "images/torre.gif" 'gif/mask) proyecto )(make-posn 75  60))
(((draw-pixmap-posn "images/torre.gif" 'gif/mask) proyecto )(make-posn 495 60))
(((draw-pixmap-posn "images/caballo.gif" 'gif/mask) proyecto )(make-posn 135 60))
(((draw-pixmap-posn "images/caballo.gif" 'gif/mask) proyecto )(make-posn 435 60))
(((draw-pixmap-posn "images/alfil.gif" 'gif/mask) proyecto )(make-posn 195 60))
(((draw-pixmap-posn "images/alfil.gif" 'gif/mask) proyecto )(make-posn 375 60))
(((draw-pixmap-posn "images/reina.gif" 'gif/mask) proyecto )(make-posn 315 60))
(((draw-pixmap-posn "images/rey.gif" 'gif/mask) proyecto )(make-posn 255 60))

(((draw-pixmap-posn "images/peon.gif" 'gif/mask) proyecto )(make-posn 75  120))
(((draw-pixmap-posn "images/peon.gif" 'gif/mask) proyecto )(make-posn 135 120))
(((draw-pixmap-posn "images/peon.gif" 'gif/mask) proyecto )(make-posn 195 120))
(((draw-pixmap-posn "images/peon.gif" 'gif/mask) proyecto )(make-posn 255 120))
(((draw-pixmap-posn "images/peon.gif" 'gif/mask) proyecto )(make-posn 315 120))
(((draw-pixmap-posn "images/peon.gif" 'gif/mask) proyecto )(make-posn 375 120))
(((draw-pixmap-posn "images/peon.gif" 'gif/mask) proyecto )(make-posn 435 120))
(((draw-pixmap-posn "images/peon.gif" 'gif/mask) proyecto )(make-posn 495 120))

(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 75 180))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 135 180))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 195 180))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 255 180))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 315 180))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 375 180))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 435 180))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 495 180))

(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 75 240))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 135 240))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 195 240))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 255 240))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 315 240))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 375 240))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 435 240))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 495 240))

(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 75 300))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 135 300))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 195 300))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 255 300))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 315 300))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 375 300))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 435 300))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 495 300))

(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 75 360))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 135 360))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 195 360))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 255 360))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 315 360))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 375 360))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 435 360))
(((draw-pixmap-posn "images/vacio.gif" 'gif/mask) proyecto )(make-posn 495 360))

(((draw-pixmap-posn "images/peon2.gif" 'gif/mask) proyecto )(make-posn 75  421))
(((draw-pixmap-posn "images/peon2.gif" 'gif/mask) proyecto )(make-posn 135 421))
(((draw-pixmap-posn "images/peon2.gif" 'gif/mask) proyecto )(make-posn 195 421))
(((draw-pixmap-posn "images/peon2.gif" 'gif/mask) proyecto )(make-posn 255 421))
(((draw-pixmap-posn "images/peon2.gif" 'gif/mask) proyecto )(make-posn 315 421))
(((draw-pixmap-posn "images/peon2.gif" 'gif/mask) proyecto )(make-posn 375 421))
(((draw-pixmap-posn "images/peon2.gif" 'gif/mask) proyecto )(make-posn 435 421))
(((draw-pixmap-posn "images/peon2.gif" 'gif/mask) proyecto )(make-posn 495 421))

(((draw-pixmap-posn "images/torre2.gif" 'gif/mask) proyecto )(make-posn 75  481))
(((draw-pixmap-posn "images/torre2.gif" 'gif/mask) proyecto )(make-posn 495 481))
(((draw-pixmap-posn "images/caballo2.gif" 'gif/mask) proyecto )(make-posn 135 481))
(((draw-pixmap-posn "images/caballo2.gif" 'gif/mask) proyecto )(make-posn 435 481))
(((draw-pixmap-posn "images/alfil2.gif" 'gif/mask) proyecto )(make-posn 195 481))
(((draw-pixmap-posn "images/alfil2.gif" 'gif/mask) proyecto )(make-posn 375 481))
(((draw-pixmap-posn "images/reina2.gif" 'gif/mask) proyecto )(make-posn 315 481))
(((draw-pixmap-posn "images/rey2.gif" 'gif/mask) proyecto )(make-posn 255 481))
(define tab_mem-posn(vector (vector "1") 
                            (vector 0 (make-posn 75  60) (make-posn 135 60) (make-posn 195 60) (make-posn 255 60) (make-posn 315 60) (make-posn 375 60) (make-posn 435 60) (make-posn 495 60) )
                            (vector 0 (make-posn 75  120) (make-posn 135 120) (make-posn 195 120) (make-posn 255 120) (make-posn 315 120) (make-posn 375 120)(make-posn 435 120) (make-posn 495 120) )
                            (vector 0 (make-posn 75 180) (make-posn 135 180) (make-posn 195 180) (make-posn 255 180) (make-posn 315 180) (make-posn 375 180) (make-posn 435 180) (make-posn 495 180) ) 
                            (vector 0 (make-posn 75 240) (make-posn 135 240) (make-posn 195 240) (make-posn 255 240) (make-posn 315 240) (make-posn 375 240) (make-posn 435 240) (make-posn 495 240))
                            (vector 0 (make-posn 75 300) (make-posn 135 300) (make-posn 195 300) (make-posn 255 300) (make-posn 315 300) (make-posn 375 300) (make-posn 435 300)  (make-posn 495 300) )
                            (vector 0 (make-posn 75 360) (make-posn 135 360) (make-posn 195 360) (make-posn 255 360) (make-posn 315 360) (make-posn 375 360) (make-posn 435 360) (make-posn 495 360) )
                            (vector 0 (make-posn 75  421) (make-posn 135  421) (make-posn 195  421) (make-posn 255  421) (make-posn 315  421) (make-posn 375  421) (make-posn 435  421) (make-posn 495 421))
                            (vector 0 (make-posn 75 481) (make-posn 135 481) (make-posn 195 481) (make-posn 255 481) (make-posn 315 481) (make-posn 375 481) (make-posn 435 481) (make-posn 495 481) )
                            )
  )
(define tab_mem(vector(vector "f/c" ) 
                      (vector " 1 " 9 10 11 12 13 14 15 16 )
                      (vector " 2 " 1 2 3 4 5 6 7 8 )
                      (vector " 3 " 0 0 0 0 0 0 0 0 ) 
                      (vector " 4 " 0 0 0 0 0 0 0 0 )
                      (vector " 5 " 0 0 0 0 0 0 0 0 )
                      (vector " 6 " 0 0 0 0 0 0 0 0 )
                      (vector " 7 " 17 18 19 20 21 22 23 24 )
                      (vector " 8 " 25 26 27 28 29 30 31 32 )
                       )
  )
(define jaque-blanca(vector (vector "f/c" 100 100 100 100 100 100 100 100 ) 
                           (vector " 1 "   9 10 11 12 13 14 15 16)
                           (vector " 2 "   1 2 3 4 5 6 7 8)
                           (vector " 3 " 0 0 0 0 0 0 0 0 ) 
                           (vector " 4 " 0 0 0 0 0 0 0 0 )
                           (vector " 5 " 0 0 0 0 0 0 0 0 )
                           (vector " 6 " 0 0 0 0 0 0 0 0 )
                           (vector " 7 " 17 18 19 20 21 22 23 24 )
                           (vector " 8 " 25 26 27 28 29 30 31 32)
                           )
  )
(define jaque-negra(vector (vector "f/c" 100 100 100 100 100 100 100 100 ) 
                           (vector " 1 "   9 10 11 12 13 14 15 16)
                           (vector " 2 "   1 2 3 4 5 6 7 8)
                           (vector " 3 " 0 0 0 0 0 0 0 0 ) 
                           (vector " 4 " 0 0 0 0 0 0 0 0 )
                           (vector " 5 " 0 0 0 0 0 0 0 0 )
                           (vector " 6 " 0 0 0 0 0 0 0 0 )
                           (vector " 7 " 17 18 19 20 21 22 23 24 )
                           (vector " 8 " 25 26 27 28 29 30 31 32)
                           )
  )
(define (turno2.0)
  (if (= bandera1 1)
      (if (and(>= ficha 1)(<= ficha 16))
          (void)
          (juego)
          )
      (if (= bandera1 0)
          (if (and(>= ficha 17)(<= ficha 32))
              (void)
              (juego)
              )
          (display "fallo de bandera 1 en turno2.0")
          )
      )
  )
(define (mostrar-turno)
  (if (= bandera1 1)
      (((draw-pixmap-posn "images/generatedtext-blancas.gif" 'gif/mask) proyecto )(make-posn 190 20))
      (((draw-pixmap-posn "images/generatedtext-negras.gif" 'gif/mask) proyecto )(make-posn 190 20))
      )
  )

(define click1 0)
(define click2 0)
(define  columnaposIni 0)
(define   posicionIni 0)
(define  columnafn 0)
(define  filafn 0)
(define  columnaposIni-borrador 0)
(define   posicionIni-borrador 0)
(define columnafn-borrador 0)
(define filafn-borrador 0)
(define bandera1 1)
(define ficha "") 
(define bandera2(vector-ref (vector-ref tab_mem 1) 1 ))
(define color 0)
(define color2 0)
(define ficha-eliminada 0)
(define guardar-ficha 0)
;--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
;--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
(define (juego)
  (mostrar-turno)
  (set! click1 (get-mouse-click proyecto))
  (set! columnaposIni (quotient (posn-x (mouse-click-posn click1)) 60))
  (set! posicionIni (quotient (posn-y (mouse-click-posn click1)) 60))
  (set! ficha(vector-ref (vector-ref tab_mem posicionIni) columnaposIni))
   (set! guardar-ficha(vector-ref (vector-ref tab_mem posicionIni) columnaposIni))
  (turno2.0)
  (set! color(if (even? (+ columnaposIni posicionIni))
                 "white"
                 "black"
                 )
        )
  (set! click2 (get-mouse-click proyecto))
  (set! columnafn (quotient (posn-x (mouse-click-posn click2)) 60))
  (set! filafn (quotient (posn-y (mouse-click-posn click2)) 60))
  (set! color2(if (even? (+ columnafn filafn))
                  "white"
                  "black"
                  )
        )
  (set! columnaposIni-borrador (* 60 columnaposIni))
  (set! posicionIni-borrador (* 60 posicionIni))
  (set! columnafn-borrador (* 60 columnafn))
  (set! filafn-borrador (* 60 filafn))
  (if (and(and (and(<= filafn 8)(>= filafn 1))(<= columnafn 8))(>= columnafn 1))
      (begin
        (set! bandera2(vector-ref (vector-ref tab_mem filafn) columnafn))
         (set! ficha-eliminada(vector-ref (vector-ref tab_mem filafn) columnafn))
        (cond
          [(or(= ficha 9)(= ficha 16)(= ficha 25)(= ficha 32))
           (if (torre filafn columnafn columnaposIni posicionIni bandera2 )
               (begin
                 (vector-set! (vector-ref jaque-blanca filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni 0 )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni 0 )
                 (if (= bandera1 1)
                     (begin
                     (jaque-blancas 1 1)
                     (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    (begin
                    (jaque-negras 1 1)
                     (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    )
                 )
               (if(and (= filafn posicionIni) (= columnaposIni columnafn)) 
                  (begin 
                    (juego)
                    )
                  (begin                                                  
                    (juego)
                    )
                  )
               )
           ]
          
          [(or(= ficha 10)(= ficha 15)(= ficha 26)(= ficha 31))
           (if (caballo filafn columnafn columnaposIni posicionIni bandera2)
               (begin
                 (vector-set! (vector-ref jaque-blanca filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni 0 )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni 0 )
                 (if (= bandera1 1)
                     (begin
                     (jaque-blancas 1 1)
                      (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    (begin
                    (jaque-negras 1 1)
                     (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (set! bandera-jaque 0)
                 (turno)
                 (juego)
                 )
                        )
                    )
                    )
                 )
               (begin 
                 (juego)
                 )
               )
           ]
          [(or(= ficha 11)(= ficha 14)(= ficha 27)(= ficha 30))
           (if (alfil filafn columnafn columnaposIni posicionIni bandera2) 
               (begin
                 (vector-set! (vector-ref jaque-blanca filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni 0 )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni 0 )
                 (if (= bandera1 1)
                     (begin
                     (jaque-blancas 1 1)
                      (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    (begin
                    (jaque-negras 1 1)
                     (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    )
                 )
               (begin 
                 (juego)
                 )
               )
           ]
          [(or(= ficha 13)(= ficha 29))
           (if (reina filafn columnafn columnaposIni posicionIni bandera2)
               (begin
                 (vector-set! (vector-ref jaque-blanca filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni 0 )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni 0 )
                 (if (= bandera1 1)
                     (begin
                     (jaque-blancas 1 1)
                      (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    (begin
                    (jaque-negras 1 1)
                     (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    )
                 )
               (begin
                 (juego)
                 )
               )
           ]
          [(or(= ficha 12)(= ficha 28))
           (if (rey  filafn columnafn columnaposIni posicionIni bandera2)
              (begin
                 (vector-set! (vector-ref jaque-blanca filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni 0 )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni 0 )
                 (if (= bandera1 1)
                     (begin
                     (jaque-blancas 1 1)
                      (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    (begin
                    (jaque-negras 1 1)
                     (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (set! bandera-jaque 0)
                 (turno)
                 (juego)
                 )
                        )
                    )
                    )
                 )
               (begin
                 (juego)
                 )
               )
           ]
          [(and(>= ficha 1)(>= 8 ficha))
           (if (peónb filafn columnafn columnaposIni posicionIni bandera2 )
              (begin
                 (vector-set! (vector-ref jaque-blanca filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni 0 )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni 0 )
                 (if (= bandera1 1)
                     (begin
                     (jaque-blancas 1 1)
                      (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    (begin
                    (jaque-negras 1 1)
                     (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    )
                 )
               (begin
                 (juego)
                 )
               )
           ]
          [(and(>= ficha 17)(>= 24 ficha))
           (if (peónn filafn columnafn columnaposIni posicionIni bandera2)
               (begin
                 (vector-set! (vector-ref jaque-blanca filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni 0 )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn ficha)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni 0 )
                 (if (= bandera1 1)
                     (begin
                     (jaque-blancas 1 1)
                      (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    (begin
                    (jaque-negras 1 1)
                     (display bandera-jaque) 
                    (if (>= bandera-jaque 1)
                        (begin
                          (set! ficha guardar-ficha)
                          (vector-set! (vector-ref jaque-blanca filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-blanca posicionIni) columnaposIni ficha )
                 (vector-set! (vector-ref jaque-negra filafn) columnafn  ficha-eliminada)
                 (vector-set! (vector-ref jaque-negra posicionIni) columnaposIni ficha )
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        (begin
                          (set! ficha guardar-ficha)
                        (vector-set! (vector-ref tab_mem filafn) columnafn ficha)
                 (vector-set! (vector-ref tab_mem posicionIni) columnaposIni 0 )
                  (usar )
                 ((draw-solid-rectangle proyecto)(make-posn  columnafn-borrador filafn-borrador) 60 60 color2)
                 (((draw-pixmap-posn ficha 'gif/mask) proyecto )(vector-ref (vector-ref tab_mem-posn filafn)columnafn))
                 ((draw-solid-rectangle proyecto)(make-posn columnaposIni-borrador posicionIni-borrador) 60 60 color)
                 (turno)
                 (set! bandera-jaque 0)
                 (juego)
                 )
                        )
                    )
                    )
                 )
               (begin
                 (juego)
                 )
               )
           ]
          )
        )
      (begin 
        (juego)
        )
      )
  )
(define (torre filafn columnafn columnaposIni posicionIni bandera2)                           ;Esta funcion es la encargada de confirmar si el movimiento que ingreso 
  (cond
    [(and (= columnafn columnaposIni) (< filafn posicionIni))
     (begin
       (if (or(= ficha 25)(= ficha 32)(= ficha 29))
           (if(or(and(>= bandera2 1)(<= bandera2 16))(= bandera2 0)) 
               (begin
                 (set! posicionIni (- posicionIni 1))
                 (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
                 (bloque-torrea-arriba filafn columnafn columnaposIni posicionIni bandera2)
                 )
               #f)
           (if (or(= ficha 9)(= ficha 16)(= ficha 13))
               (if (or(and(>= bandera2 17)(<= bandera2 32))(= bandera2 0))
                   (begin
                     (set! posicionIni (- posicionIni 1))
                     (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
                     (bloque-torrea-arriba filafn columnafn columnaposIni posicionIni bandera2)
                     )
                   #f)
               #f)
           )
       )]
    [(and (= columnafn columnaposIni) (> filafn posicionIni))
     (begin
       (if (or(= ficha 25)(= ficha 32)(= ficha 29))
           (if (or(and(>= bandera2 1)(<= bandera2 16))(= bandera2 0))
               (begin
                 (set! posicionIni (+ posicionIni 1))
                 (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
                 (bloque-torrea-abajo filafn columnafn columnaposIni posicionIni bandera2)
                 )
               #f)
           (if (or(= ficha 9)(= ficha 16)(= ficha 13))
               (if (or(and(>= bandera2 17)(<= bandera2 32))(= bandera2 0))
                   (begin
                     (set! posicionIni (+ posicionIni 1))
                     (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
                     (bloque-torrea-abajo filafn columnafn columnaposIni posicionIni bandera2)
                     )
                   #f)
               #f)
           )
       )]
    [(and (= filafn posicionIni) (> columnaposIni columnafn))
     (if (or(= ficha 25)(= ficha 32)(= ficha 29))
         (if (or(and(>= bandera2 1)(<= bandera2 16))(= bandera2 0))
             (begin
               (set! columnaposIni (- columnaposIni 1))
               (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
               (bloque-torrea-izquierda filafn columnafn columnaposIni posicionIni bandera2)
               )
             #f)
         (if (or(= ficha 9)(= ficha 16)(= ficha 13))
             (if (or(and(>= bandera2 17)(<= bandera2 32))(= bandera2 0))
                 (begin
                   (set! columnaposIni (- columnaposIni 1))
                   (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
                   (bloque-torrea-izquierda filafn columnafn columnaposIni posicionIni bandera2)
                   )
                 #f)
             #f)
         )]
    [(and (= filafn posicionIni) (< columnaposIni columnafn))
     (if (or(= ficha 25)(= ficha 32)(= ficha 29))
         (if (or(and(>= bandera2 1)(<= bandera2 16))(= bandera2 0))
             (begin
               (set! columnaposIni (+ columnaposIni 1))
               (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
               (bloque-torrea-derecha filafn columnafn columnaposIni posicionIni bandera2)
               )
             #f)
         (if (or(= ficha 9)(= ficha 16)(= ficha 13))
             (if (or(and(>= bandera2 17)(<= bandera2 32))(= bandera2 0))
                 (begin
                   (set! columnaposIni (+ columnaposIni 1))
                   (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
                   (bloque-torrea-derecha filafn columnafn columnaposIni posicionIni bandera2)
                   )
                 #f)
             #f)
         )]
    [else #f ]
    )
  )
(define (alfil filafn columnafn columnaposIni posicionIni bandera2)                                ;Esta funcion es la encargada de confirmar si el movimiento que ingreso 
  (cond
    [(= (abs(- posicionIni filafn))(abs(- columnaposIni columnafn)))
     (if (or(= ficha 27)(= ficha 30)(= ficha 29))
         (if (or(and(>= bandera2 1)(<= bandera2 16))(= bandera2 0))
             (begin
               (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
               (bloqueo-de-alfil filafn columnafn columnaposIni posicionIni bandera2)
               )
             #f)
         (if (or(= ficha 11)(= ficha 14)(= ficha 13))
             (if (or(and(>= bandera2 17)(<= bandera2 32))(= bandera2 0))
                 (begin
                   (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni ) columnaposIni ))
                   (bloqueo-de-alfil filafn columnafn columnaposIni posicionIni bandera2)
                   )
                 #f)
             #f)
         )
     ]
    [else #f ]
    )
  )
(define (reina  filafn  columnafn columnaposIni posicionIni bandera2)                                 ;Esta funcion es la encargada de confirmar si el movimiento que ingreso 
  (cond
    [(torre filafn columnafn columnaposIni posicionIni bandera2) #t]
    [(alfil filafn columnafn columnaposIni posicionIni bandera2) #t]
    [else #f]
    )
  )
(define (caballo  filafn columnafn columnaposIni posicionIni bandera2)                           ;Esta funcion es la encargada de confirmar si el movimiento que ingreso 
  (cond
    [(and (= filafn (- posicionIni 2))(= columnafn (- columnaposIni 1))) (bloque-de-caballo bandera2)];listo
    [(and (= filafn  (- posicionIni 2)) (= columnafn (+ columnaposIni 1))) (bloque-de-caballo bandera2)];listo
    [(and (= filafn (+ posicionIni 2)) (= columnafn (- columnaposIni 1))) (bloque-de-caballo bandera2)];listo
    [(and (= filafn (+ posicionIni 2)) (= columnafn (+ columnaposIni 1))) (bloque-de-caballo bandera2)];listo
    [(and (= filafn (- posicionIni 1))) (= columnafn (+ columnaposIni 2))(bloque-de-caballo bandera2)];listo
    [(and (= filafn (- posicionIni 1)) (= columnafn (- columnaposIni 2))) (bloque-de-caballo bandera2)];listo
    [(and (= filafn (+ posicionIni 1)) (= columnafn (- columnaposIni 2))) (bloque-de-caballo bandera2)];listo
    [(and (= filafn (+ posicionIni 1)) (= columnafn (+ columnaposIni 2))) (bloque-de-caballo bandera2)];listo
    [else #f]
    )
  )
(define (peónb filafn columnafn columnaposIni posicionIni bandera2)                            ;Esta funcion es la encargada de confirmar si el movimiento que ingreso 
  (if
   (= posicionIni 2)
   (cond
     [(and(= filafn (+ posicionIni 1))(= columnaposIni columnafn)) (bloqueo-peón-blanco filafn columnafn columnaposIni posicionIni bandera2) ]
     [(and(= filafn (+ posicionIni 2))(= columnaposIni columnafn)) (bloqueo-peón-blanco filafn columnafn columnaposIni posicionIni bandera2) ]
     [(and(= filafn (+ posicionIni 1))(or(= columnafn (+ columnaposIni 1))(= columnafn (- columnaposIni 1)))) (ataque-del-peón filafn columnafn columnaposIni posicionIni bandera2)  ]
     [else #f]
     )
   (cond
     [(and(= filafn (+ posicionIni 1))(= columnaposIni columnafn)) (bloqueo-peón-blanco filafn columnafn columnaposIni posicionIni bandera2) ]
     [(and(= filafn (+ posicionIni 1))(or(= columnafn (+ columnaposIni 1))(= columnafn (- columnaposIni 1)))) (ataque-del-peón filafn columnafn columnaposIni posicionIni bandera2)  ]
     [else #f]
     )
   )
  )
(define (peónn filafn columnafn columnaposIni posicionIni bandera2)                         ;Esta funcion es la encargada de confirmar si el movimiento que ingreso                                                                          ;el usuario es valído para la ficha peón negro
  (if
   (= posicionIni 7)
   (cond
     [(and(= filafn (- posicionIni 1))(= columnaposIni columnafn)) (bloqueo-peón-negro filafn columnafn columnaposIni posicionIni bandera2) ]
     [(and(= filafn (- posicionIni 2))(= columnaposIni columnafn)) (bloqueo-peón-negro filafn columnafn columnaposIni posicionIni bandera2) ]
     [(and(= filafn (- posicionIni 1))(or(= columnafn (+ columnaposIni 1))(= columnafn (- columnaposIni 1)))) (ataque-del-peón filafn columnafn columnaposIni posicionIni bandera2)  ]
     [else #f]
     )
   (cond
     [(and(= filafn (- posicionIni 1))(= columnaposIni columnafn)) (bloqueo-peón-negro filafn columnafn columnaposIni posicionIni bandera2) ]
     [(and(= filafn (- posicionIni 1))(or(= columnafn (+ columnaposIni 1))(= columnafn (- columnaposIni 1)))) (ataque-del-peón filafn columnafn columnaposIni posicionIni bandera2)  ]
     [else #f]
     )
   )
  )
(define (rey filafn columnafn columnaposIni posicionIni bandera2 )                             ;Esta funcion es la encargada de confirmar si el movimiento que ingreso
  (cond
    [(and (= filafn (abs(- posicionIni 1)))(= columnafn columnaposIni )) (bloque-torrea-arriba filafn columnafn columnaposIni posicionIni bandera2)]
    [(and (= filafn (+ posicionIni 1)) (= columnafn columnaposIni )) (bloque-torrea-abajo filafn columnafn columnaposIni posicionIni  bandera2)]
    [(and (= filafn  posicionIni ) (= columnafn (+ columnaposIni 1))) (bloque-torrea-derecha filafn columnafn columnaposIni posicionIni  bandera2) ]
    [(and (= filafn  posicionIni) (= columnafn (- columnaposIni 1))) (bloque-torrea-izquierda filafn columnafn columnaposIni posicionIni  bandera2)]
    [(and (= filafn (abs(- posicionIni 1))) (= columnafn (+ columnaposIni 1))) (bloqueo-de-alfil filafn columnafn columnaposIni posicionIni bandera2) ]
    [(and (= filafn (abs(- posicionIni 1))) (= columnafn (abs(- columnaposIni 1)))) (bloqueo-de-alfil filafn columnafn columnaposIni posicionIni bandera2) ]
    [(and (= filafn (+ posicionIni 1)) (= columnafn (abs(- columnaposIni 1)))) (bloqueo-de-alfil filafn columnafn columnaposIni posicionIni bandera2) ]
    [(and (= filafn (+ posicionIni 1)) (= columnafn (+ columnaposIni 1))) (bloqueo-de-alfil filafn columnafn columnaposIni posicionIni bandera2) ]
    [else #f]
    )
  )
(define (bloque-torrea-arriba filafn columnafn columnaposIni posicionIni  bandera2 )
  (if (< filafn posicionIni )
      (if (equal?  0 bandera2)
          (begin
            (set! posicionIni (- posicionIni 1))
            (set! bandera2(vector-ref (vector-ref tab_mem  posicionIni ) columnafn))
            (bloque-torrea-arriba filafn columnafn columnaposIni posicionIni bandera2)
            )
          #f)
      #t)
  )
(define (bloque-torrea-abajo filafn columnafn columnaposIni posicionIni  bandera2)
  (if (> filafn posicionIni )
      (if (equal?  0 bandera2)
          (begin
            (set! posicionIni (+ posicionIni 1))
            (set! bandera2(vector-ref (vector-ref tab_mem  posicionIni ) columnafn))
            (bloque-torrea-abajo filafn columnafn columnaposIni posicionIni bandera2)
            )
          #f)
      #t)
  )
(define (bloque-torrea-derecha filafn columnafn columnaposIni posicionIni  bandera2)
  (if (> columnafn columnaposIni )
      (if (equal?  0 bandera2)
          (begin
            (set! columnaposIni (+ columnaposIni 1))
            (set! bandera2(vector-ref (vector-ref tab_mem  filafn ) columnaposIni))
            (bloque-torrea-derecha filafn columnafn columnaposIni posicionIni bandera2)
            )
          #f)
      #t)
  )
(define (bloque-torrea-izquierda filafn columnafn columnaposIni posicionIni  bandera2)
  (if (<= columnafn columnaposIni )
      (if (equal?  0 bandera2)
          (begin
            (set! columnaposIni (- columnaposIni 1))
            (set! bandera2(vector-ref (vector-ref tab_mem  filafn ) columnaposIni))
            (bloque-torrea-izquierda filafn columnafn columnaposIni posicionIni bandera2)
            )
          #f)
      #t)
  )
(define (bloqueo-de-alfil filafn columnafn columnaposIni posicionIni bandera2)
  (cond
    [(and(> (- posicionIni filafn)  0)(< (- columnaposIni columnafn)  0))                       ;va hacia arriba y a la derecha
     (begin
       (set! columnaposIni (+ columnaposIni 1))
       (set! posicionIni (- posicionIni 1))
       (set! bandera2(vector-ref (vector-ref tab_mem  posicionIni ) columnaposIni))
       (bloqueo-alfil-arribaderecha filafn columnafn columnaposIni posicionIni bandera2)
       )
     ]        
    [(and(> (- posicionIni filafn) 0)(> (- columnaposIni columnafn)  0))
     (begin
       (set! columnaposIni (- columnaposIni 1))
       (set! posicionIni (- posicionIni 1))
       (set! bandera2(vector-ref (vector-ref tab_mem  posicionIni ) columnaposIni))
       (bloqueo-alfil-arribaizquierda filafn columnafn columnaposIni posicionIni bandera2)
       )
     ]
    [(and(< (- posicionIni filafn)  0)(< (- columnaposIni columnafn)  0))
     (begin
       (set! columnaposIni (+ columnaposIni 1))
       (set! posicionIni (+ posicionIni 1))
       (set! bandera2(vector-ref (vector-ref tab_mem  posicionIni ) columnaposIni))
       (bloqueo-alfil-abajoderecha filafn columnafn columnaposIni posicionIni bandera2)
       )
     ]
    [(and(< (- posicionIni filafn) 0)(> (- columnaposIni columnafn)  0))
     (begin
       (set! columnaposIni (- columnaposIni 1))
       (set! posicionIni (+ posicionIni 1))
       (set! bandera2(vector-ref (vector-ref tab_mem  posicionIni ) columnaposIni))
       (bloqueo-alfil-abajoizquierda filafn columnafn columnaposIni posicionIni bandera2)
       )
     ]
    [else #f]
    )
  )
(define (bloqueo-alfil-arribaderecha filafn columnafn columnaposIni posicionIni bandera2)
  (if(> columnafn columnaposIni)
     (if (equal?  0 bandera2)
         (begin
           (set! columnaposIni (+ columnaposIni 1))
           (set! posicionIni (- posicionIni 1))
           (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni) columnaposIni))
           (bloqueo-alfil-arribaderecha filafn columnafn columnaposIni posicionIni bandera2)
           )
         #f)
     #t)
  )
(define (bloqueo-alfil-arribaizquierda filafn columnafn columnaposIni posicionIni bandera2)
  (if (< columnafn columnaposIni)
      (if (equal?  0 bandera2)
          (begin
            (set! columnaposIni (- columnaposIni 1))
            (set! posicionIni (- posicionIni 1))
            (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni) columnaposIni))
            (bloqueo-alfil-arribaizquierda filafn columnafn columnaposIni posicionIni bandera2)
            )
          #f)
      #t)
  )
(define (bloqueo-alfil-abajoderecha filafn columnafn columnaposIni posicionIni bandera2)
  (if (> columnafn columnaposIni)
      (if (equal?  0 bandera2)
          (begin
            (set! columnaposIni (+ columnaposIni 1))
            (set! posicionIni (+ posicionIni 1))
            (set! bandera2 (vector-ref (vector-ref tab_mem posicionIni) columnaposIni))
            (bloqueo-alfil-abajoderecha filafn columnafn columnaposIni posicionIni bandera2)
            )
          #f)
      #t)
  )
(define (bloqueo-alfil-abajoizquierda filafn columnafn columnaposIni posicionIni bandera2)
  (if (< columnafn columnaposIni)
      (if (equal?  0 bandera2)
          (begin
            (set! columnaposIni (- columnaposIni 1))
            (set! posicionIni (+ posicionIni 1))
            (set! bandera2(vector-ref (vector-ref tab_mem posicionIni) columnaposIni))
            (bloqueo-alfil-abajoizquierda filafn columnafn columnaposIni posicionIni bandera2)
            )
          #f)
      #t)
  )
(define (bloqueo-peón-blanco filafn columnafn columnaposIni posicionIni bandera2)
  (if (> filafn posicionIni)
      (if (equal?  0 bandera2)
          (begin
            (set! posicionIni (+ posicionIni 1))
            (set! bandera2(vector-ref (vector-ref tab_mem posicionIni) columnafn))
            (bloqueo-peón-blanco filafn columnafn columnaposIni posicionIni bandera2)
            )
          #f)
      #t)
  )
(define (bloqueo-peón-negro filafn columnafn columnaposIni posicionIni bandera2)
  (if (< filafn posicionIni)
      (if (equal?  0  bandera2)
          (begin
            (set! posicionIni (- posicionIni 1))
            (set! bandera2(vector-ref (vector-ref tab_mem posicionIni) columnafn))
            (bloqueo-peón-blanco filafn columnafn columnaposIni posicionIni bandera2)
            )
          #f)
      #t)
  )
(define (bloque-de-caballo bandera2)
  (if (or(= ficha 26)(= ficha 31))
      (if (or(and(>= bandera2 1)(<= bandera2 16))(= bandera2 0))
          #t
          #f)
      (if (or(= ficha 10)(= ficha 15))
          (if (or(and(>= bandera2 17)(<= bandera2 32))(= bandera2 0))
              #t
              #f)
          #f)
      )
  )
(define (ataque-del-peón filafn columnafn columnaposIni posicionIni bandera2)
  (if (and(>= ficha 17)(<= ficha 24))
      (if (and(>= bandera2 1)(<= bandera2 16))
          #t
          #f)
      (if (and(>= ficha 1)(<= ficha 8))
          (if (and(>= bandera2 17)(<= bandera2 32))
              #t
              #f)
          #f)
      )
  )

(define (turno )
  (if (= bandera1 0)
      (set! bandera1 1)
      (set! bandera1 0)
      )
  )
(define (usar )
  (cond
    ((and (>= ficha 1) (<= ficha 8))  (set! ficha "images/peon.gif"))
    ((or (= ficha 32)(= ficha 25))      (set! ficha "images/torre2.gif"))
    ((or (= ficha 27)(= ficha 30))      (set! ficha "images/alfil2.gif"))
    ((or (= ficha 26)(= ficha 31))    (set! ficha   "images/caballo2.gif"))
    ((or (= ficha 10)(= ficha 15))     (set! ficha  "images/caballo.gif"))
    ((= ficha 29)                     (set! ficha  "images/reina2.gif"))
    ((= ficha 28)                     (set! ficha  "images/rey2.gif"))
    ((and (>= ficha 17) (<= ficha 24))(set! ficha "images/peon2.gif"))
    ((or (= ficha 9)(= ficha 16))     (set! ficha "images/torre.gif"))
    ((or (= ficha 11)(= ficha 14))    (set! ficha "images/alfil.gif"))
    ((= ficha 13)                      (set! ficha "images/reina.gif"))
    ((= ficha 12)                      (set! ficha "images/rey.gif"))
    (else  (display "ficha inexistente en el juego"))
    )
  )


(define guardar-valor-en-y 0)
(define guardar-valor-en-x 0)
(define bandera-jaque 0)
(define (ataque-del-peón-jaque  x y guardar-valor-en-x guardar-valor-en-y bandera2)
  (if (and(>= ficha 17)(<= ficha 24))
      (if(or(equal? bandera2 33)(equal? bandera2 0))
         (begin
           (vector-set!(vector-ref jaque-blanca y )x 33)
           #f)
         (if(equal? bandera2 12)
            #t
            #f)
         )
      (if (and(>= ficha 1)(<= ficha 8))
          (if(or(equal? bandera2 34)(equal? bandera2 0))
             (begin
               (vector-set!(vector-ref jaque-negra y )x 34)
               #f)
             (if (equal? bandera2 28)
                 #t
                 #f)
             )
          #f)
      )
  )

(define (bloque-torrea-arriba-jaque x y   guardar-valor-en-y bandera2 )
  (if (< 0 y)
      (if(or(= 25 ficha)(= ficha 32)(= ficha 29))
         (if (or(equal?  0 bandera2)(equal? 33 bandera2))
             (begin
               (vector-set!(vector-ref jaque-blanca y )x 33)
               (set! y (- y 1))
               (set! bandera2(vector-ref (vector-ref jaque-blanca  y ) x))
               (bloque-torrea-arriba-jaque x y   guardar-valor-en-y bandera2 )
               )
             (begin
               (if(equal? bandera2 12)
                  #t
                  #f)
               )
             )
         (if(or(= 9 ficha)(= 16 ficha)(= ficha 13))
            (if (or(equal?  0 bandera2)(equal? 34 bandera2))
                (begin
                  (vector-set!(vector-ref jaque-negra y )x 34)
                  (set! y (- y 1))
                  (set! bandera2(vector-ref (vector-ref jaque-negra  y ) x))
                  (bloque-torrea-arriba-jaque x y guardar-valor-en-y bandera2 )
                  )
                (if(equal? bandera2 28)
                   #t
                   #f)
                )
            (void)
            )
         )
      (begin
        #f)
      )
  )
(define (bloque-torrea-abajo-jaque x y  guardar-valor-en-y bandera2)
  (if(or(= 25 ficha)(= ficha 32)(= ficha 29))
     (if (or(equal?  0 bandera2)(equal? 33 bandera2))
         (begin
           (vector-set!(vector-ref jaque-blanca y )x 33)
           (if (> 9 (+ 1 y ))
               (begin
                 (set! y (+ y 1))
                 (set! bandera2(vector-ref (vector-ref jaque-blanca  y ) x))
                 (bloque-torrea-abajo-jaque x y  guardar-valor-en-y bandera2)
                 )
               (begin
                 #f)
               )
           )
         (begin
           (if(equal? bandera2 12)
              #t
              #f)
           )
         )
     (if(or(= 9 ficha)(= 16 ficha)(= ficha 13))
        (if (or(equal?  0 bandera2)(equal? 34 bandera2))
            (begin
              (vector-set!(vector-ref jaque-negra y )x 34)
              (if (> 9 (+ 1 y ))
                  (begin
                    (set! y (+ y 1))
                    (set! bandera2(vector-ref (vector-ref jaque-negra  y ) x))
                    (bloque-torrea-abajo-jaque x y  guardar-valor-en-y bandera2)
                    )
                  (begin
                    #f)
                  )
              )
            (if(equal? bandera2 28)
               #t
               #f)
            )
        (void)
        )
     )
  )
(define (bloque-torrea-derecha-jaque x y  guardar-valor-en-x bandera2)
  (if (> 9 x )
      (if(or(= 25 ficha)(= ficha 32)(= ficha 29)) 
         (if (or(equal?  0 bandera2)(equal? 33 bandera2))
             (begin
               (vector-set!(vector-ref jaque-blanca y )x 33)
               (if (> 9 (+ 1 x ))
                   (begin
                     (set! x (+ x 1))
                     (set! bandera2(vector-ref (vector-ref jaque-blanca  y ) x))
                     (bloque-torrea-derecha-jaque x y  guardar-valor-en-x bandera2)
                     )
                   (begin
                     #f)
                   )
               )
             (begin
               (if(equal? bandera2 12)
                  #t
                  #f)
               )
             )
         (if(or(= 9 ficha)(= 16 ficha)(= ficha 13))
            (if (or(equal?  0 bandera2)(equal? 34 bandera2))
                (begin
                  (vector-set!(vector-ref jaque-negra y )x 34)
                  (if (> 9 (+ 1 x ))
                      (begin
                        (set! x (+ x 1))
                        (set! bandera2(vector-ref (vector-ref jaque-negra  y ) x))
                        (bloque-torrea-derecha-jaque x y  guardar-valor-en-x bandera2)
                        )
                      (begin
                        #f)
                      )
                  )
                (if(equal? bandera2 28)
                   #t
                   #f)
                )
            (void)
            )
         )
      (begin
        #f)
      )
  )
(define (bloque-torrea-izquierda-jaque x y guardar-valor-en-x bandera2)
  (if (>= x 1)
      (if(or(= 25 ficha)(= ficha 32)(= ficha 29))
         (if (or(equal?  0 bandera2)(equal? 33 bandera2))
             (begin
               (vector-set!(vector-ref jaque-blanca y )x 33)
               (set! x (- x 1))
               (set! bandera2(vector-ref (vector-ref jaque-blanca  y ) x))
               (bloque-torrea-izquierda-jaque x y  guardar-valor-en-x bandera2)
               )
             (begin
               (if(equal? bandera2 12)
                  #t
                  #f)
               )
             )
         (if(or(= 9 ficha)(= 16 ficha)(= ficha 13))
            (if (equal?  0 bandera2)
                (begin
                  (vector-set!(vector-ref jaque-negra y )x 34)
                  (set! x (- x 1))
                  (set! bandera2(vector-ref (vector-ref jaque-negra  y ) x))
                  (bloque-torrea-izquierda-jaque x y  guardar-valor-en-x bandera2)
                  )
                (if(equal? bandera2 28)
                   #t
                   #f)
                )
            (void)
            )
         )
      (begin
        #f)
      )
  )
(define (bloque-de-caballo-jaque x y bandera2)
  (if (or(= ficha 26)(= ficha 31))
      (if(or(equal? bandera2 33) (equal? bandera2 0))
         (begin
           (vector-set!(vector-ref jaque-blanca y )x 33)
           #f)
         (if(equal? bandera2 12)
            #t
            #f)
         )
      (if (or(= ficha 10)(= ficha 15))
          (if(or(equal? bandera2 34) (equal? bandera2 0))
             (begin
               (vector-set!(vector-ref jaque-negra y )x 34)
               #f)
             (if(equal? bandera2 28)
                #t
                #f)
             )
          (void)
          )
      )
  )
(define (bloqueo-alfil-arribaderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2 )
  (if(or(= 27 ficha)(= ficha 30)(= ficha 29))
     (if (or(equal?  0 bandera2)(equal? 33 bandera2))
         (begin
           (vector-set!(vector-ref jaque-blanca y )x 33)
           (if (> 9 (+ x 1) )
               (begin
                 (set! x (+ x 1))
                 (set! y (- y 1))
                 (set! bandera2(vector-ref (vector-ref jaque-blanca  y ) x))
                 (bloqueo-alfil-arribaderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2 )
                 )
               #f)
           )
         (if(equal? bandera2 12)
            #t
            #f)
         )
     (if(or(= 11 ficha)(= 14 ficha)(= ficha 13))
        (if (or(equal?  0 bandera2)(equal? 34 bandera2))
            (begin
              (vector-set!(vector-ref jaque-negra y )x 34)
              (if (> 9 (+ x 1) )
                  (begin
                    (set! x (+ x 1))
                    (set! y (- y 1))
                    (set! bandera2(vector-ref (vector-ref jaque-negra  y ) x))
                    (bloqueo-alfil-arribaderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2 )
                    )
                  #f)
              )
            (if(equal? bandera2 28)
               #t
               #f)
            )
        (void)
        )
     )
  )
(define (bloqueo-alfil-arribaizquierda-jaque  x y  guardar-valor-en-x guardar-valor-en-y bandera2)
  (if(or(= 27 ficha)(= ficha 30)(= ficha 29))
     (if (or(equal?  0 bandera2)(equal? 33 bandera2))
         (begin
           (vector-set!(vector-ref jaque-blanca y )x 33)
           (if (< 0 (- x 1))
               (begin
                 (set! x (- x 1))
                 (set! y (- y 1))
                 (set! bandera2(vector-ref (vector-ref jaque-blanca y ) x))
                 (bloqueo-alfil-arribaizquierda-jaque  x y  guardar-valor-en-x guardar-valor-en-y bandera2)
                 )
               #f)
           )
         (if(equal? bandera2 12)
            #t
            #f)
         )
     (if(or(= 11 ficha)(= 14 ficha)(= ficha 13))
        (if (or(equal?  0 bandera2)(equal? 34 bandera2))
            (begin
              (vector-set!(vector-ref jaque-negra y )x 34)
              (if (< 0 (- x 1))
                  (begin
                    (set! x (- x 1))
                    (set! y (- y 1))
                    (set! bandera2(vector-ref (vector-ref jaque-negra y ) x))
                    (bloqueo-alfil-arribaizquierda-jaque  x y  guardar-valor-en-x guardar-valor-en-y bandera2)
                    )
                  #f)
              )
            (if(equal? bandera2 28)
               #t
               #f)
            )
        (void)
        )
     )
  )
(define (bloqueo-alfil-abajoderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
  (if(or(= 27 ficha)(= ficha 30)(= ficha 29))
     (if (or(equal?  0 bandera2)(equal? 33 bandera2))
         (begin
           (vector-set!(vector-ref jaque-blanca y )x 33)
           (if (and(> 9 (+ 1 x))(> 9 (+ y 1)))
               (begin
                 (set! x (+ x 1))
                 (set! y (+ y 1))
                 (set! bandera2(vector-ref (vector-ref jaque-blanca y ) x))
                 (bloqueo-alfil-abajoderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
                 )
               #f)
           )
         (if(equal? bandera2 12)
            #t
            #f)
         )
     (if(or(= 11 ficha)(= 14 ficha)(= ficha 13))
        (if (or(equal?  0 bandera2)(equal? 34 bandera2))
            (begin
              (vector-set!(vector-ref jaque-negra y )x 34)
              (if (and(> 9 (+ 1 x))(> 9 (+ y 1)))
                  (begin
                    (set! x (+ x 1))
                    (set! y (+ y 1))
                    (set! bandera2(vector-ref (vector-ref jaque-negra y ) x))
                    (bloqueo-alfil-abajoderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
                    )
                  #f)
              )
            (if(equal? bandera2 28)
               #t
               #f)
            )
        (void)
        )
     )
  )
(define (bloqueo-alfil-abajoizquierda-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
  (if(or(= 27 ficha)(= ficha 30)(= ficha 29))
     (if (or(equal?  0 bandera2)(equal? 33 bandera2))
         (begin
           (vector-set!(vector-ref jaque-blanca y )x 33)
           (if (and(< 0 (- x 1))(> 9 (+ y 1)))
               (begin
                 (set! x (- x 1))
                 (set! y (+ y 1))
                 (set! bandera2(vector-ref (vector-ref jaque-blanca  y ) x))
                 (bloqueo-alfil-abajoizquierda-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
                 )
               #f)
           )
         (if(equal? bandera2 12)
            #t
            #f)
         )
     (if(or(= 11 ficha)(= 14 ficha)(= ficha 13))
        (if (or(equal?  0 bandera2)(equal? 34 bandera2))
            (begin
              (vector-set!(vector-ref jaque-negra y )x 34)
              (if (and(< 0 (- x 1))(> 9 (+ y 1)))
                  (begin
                    (set! x (- x 1))
                    (set! y (+ y 1))
                    (set! bandera2(vector-ref (vector-ref jaque-negra  y ) x))
                    (bloqueo-alfil-abajoizquierda-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
                    )
                  #f)
              )
            (if(equal? bandera2 28)
               #t
               #f)
            )
        (void)
        )
     )
  )
(define(alfil-jaque  x y  )  
  (if(or(= 27 ficha)(= 30 ficha)(= 29 ficha))
     (begin
       (set! guardar-valor-en-y y)
       (set! guardar-valor-en-x x)
       (if(< (+ x 1) 9)
          (begin
            (set! y (abs(- y 1)))
            (set! x (abs(+ x 1)))
            (set! bandera2 (vector-ref(vector-ref jaque-blanca  y)  x ))
            (if (bloqueo-alfil-arribaderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2 )
                (begin
                  (set! x guardar-valor-en-x )
                  (set! y guardar-valor-en-y )
                  (set! bandera-jaque (+ bandera-jaque 1))
                  )
                (begin
                  (set! x guardar-valor-en-x )
                  (set! y guardar-valor-en-y )
                  )
                )
            )
          (void)
          )
       (if(< 0 (- x 1))
          (begin
            (set! guardar-valor-en-y y)
            (set! guardar-valor-en-x x)
            (set! y (abs(- y 1)))
            (set! x (abs(- x 1)))
            (set! bandera2 (vector-ref(vector-ref jaque-blanca  y)  x ))
            (if (bloqueo-alfil-arribaizquierda-jaque  x y  guardar-valor-en-x guardar-valor-en-y bandera2)
                (begin
                  (set! x guardar-valor-en-x )
                  (set! y guardar-valor-en-y )
                  (set! bandera-jaque (+ bandera-jaque 1))
                  )
                (begin
                  (set! x guardar-valor-en-x )
                  (set! y guardar-valor-en-y )
                  )
                )
            )
          (void)
          )
       (if(and(< (+ x 1) 9)(< (+ y 1) 9))
          (begin
            (set! guardar-valor-en-y y)
            (set! guardar-valor-en-x x)
            (set! y (abs(+ y 1)))
            (set! x (abs(+ x 1)))
            (set! bandera2 (vector-ref(vector-ref jaque-blanca  y)  x ))
            (if(bloqueo-alfil-abajoderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
               (begin
                 (set! x guardar-valor-en-x )
                 (set! y guardar-valor-en-y )
                 (set! bandera-jaque (+ bandera-jaque 1))
                 )
               (begin
                 (set! x guardar-valor-en-x )
                 (set! y guardar-valor-en-y )
                 )
               )
            )
          (void)
          )
       (if(and(< 0 (- x 1))(< (+ y 1) 9))
          (begin
            (set! guardar-valor-en-y y)
            (set! guardar-valor-en-x x)
            (set! y (abs(+ y 1)))
            (set! x (abs(- x 1)))
            (set! bandera2 (vector-ref(vector-ref jaque-blanca  y)  x ))
            (if(bloqueo-alfil-abajoizquierda-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
               (begin
                 (set! x guardar-valor-en-x )
                 (set! y guardar-valor-en-y )
                 (set! bandera-jaque (+ bandera-jaque 1))
                 (set! x(+ x 1))
                 (jaque-blancas x y )
                 ) 
               (begin
                 (set! x guardar-valor-en-x )
                 (set! y guardar-valor-en-y )
                 (set! x(+ x 1))
                 (jaque-blancas x y )
                 )
               )
            )
          (begin
            (set! x guardar-valor-en-x )
            (set! y guardar-valor-en-y )
            (set! x(+ x 1))
            (jaque-blancas x y )
            )
          )
       )
     (begin
       (set! guardar-valor-en-y y)
       (set! guardar-valor-en-x x)
       (set! x(+ x 1))
       (jaque-blancas x y )
       )
     )
  )
;---------------------------------------------------------------------------------------------------------------------------------------------------
;---------------------------------------------------------------------------------------------------------------------------------------------------
(define(alfil-jaque-negra  x y  ) 
  (if(or(= 11 ficha)(= 14 ficha)(= ficha 13))
     (begin
       (set! guardar-valor-en-y y)
       (set! guardar-valor-en-x x)
       (if(< (+ x 1) 9)
          (begin
            (set! y (abs(- y 1)))
            (set! x (abs(+ x 1)))
            (set! bandera2 (vector-ref(vector-ref jaque-negra  y)  x ))
            (if (bloqueo-alfil-arribaderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2 )
                (begin
                  (set! x guardar-valor-en-x )
                  (set! y guardar-valor-en-y )
                  (set! bandera-jaque (+ bandera-jaque 1))
                  )
                (begin
                  (set! x guardar-valor-en-x )
                  (set! y guardar-valor-en-y )
                  )
                )
            )
          (void)
          )
       (if(< 0 (- x 1))
          (begin
            (set! guardar-valor-en-y y)
            (set! guardar-valor-en-x x)
            (set! y (abs(- y 1)))
            (set! x (abs(- x 1)))
            (set! bandera2 (vector-ref(vector-ref jaque-negra  y)  x ))
            (if (bloqueo-alfil-arribaizquierda-jaque  x y  guardar-valor-en-x guardar-valor-en-y bandera2)
                (begin
                  (set! x guardar-valor-en-x )
                  (set! y guardar-valor-en-y )
                  (set! bandera-jaque (+ bandera-jaque 1))
                  )
                (begin
                  (set! x guardar-valor-en-x )
                  (set! y guardar-valor-en-y )
                  )
                )
            )
          (void)
          )
       (if(and(< (+ x 1) 9)(< (+ y 1) 9))
          (begin
            (set! guardar-valor-en-y y)
            (set! guardar-valor-en-x x)
            (set! y (abs(+ y 1)))
            (set! x (abs(+ x 1)))
            (set! bandera2 (vector-ref(vector-ref jaque-negra  y)  x ))
            (if(bloqueo-alfil-abajoderecha-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
               (begin
                 (set! x guardar-valor-en-x )
                 (set! y guardar-valor-en-y )
                 (set! bandera-jaque (+ bandera-jaque 1))
                 )
               (begin
                 (set! x guardar-valor-en-x )
                 (set! y guardar-valor-en-y )
                 )
               )
            )
          (void)
          )
       (if(and(< 0 (- x 1))(< (+ y 1) 9))
          (begin
            (set! guardar-valor-en-y y)
            (set! guardar-valor-en-x x)
            (set! y (abs(+ y 1)))
            (set! x (abs(- x 1)))
            (set! bandera2 (vector-ref(vector-ref jaque-negra  y)  x ))
            (if(bloqueo-alfil-abajoizquierda-jaque x y  guardar-valor-en-x guardar-valor-en-y bandera2)
               (begin
                 (set! x guardar-valor-en-x )
                 (set! y guardar-valor-en-y )
                 (set! bandera-jaque (+ bandera-jaque 1))
                 (set! x(+ x 1))
                 (jaque-negras x y )
                 ) 
               (begin
                 (set! x guardar-valor-en-x )
                 (set! y guardar-valor-en-y )
                 (set! x(+ x 1))
                 (jaque-negras x y )
                 )
               )
            )
          (begin
            (set! x guardar-valor-en-x )
            (set! y guardar-valor-en-y )
            (set! x(+ x 1))
            (jaque-negras x y )
            )
          )
       )
     (begin
       (set! guardar-valor-en-y y)
       (set! guardar-valor-en-x x)
       (set! x(+ x 1))
       (jaque-negras x y )
       )
     )
  )
;-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
(define (jaque-blancas x y )
  (if (and(>= x 0)(<= x 8)(>= y 0)(<= y 8))
      (begin
        (set! ficha(vector-ref(vector-ref jaque-blanca y)x))
        (if(and(<= 17 ficha)(<= ficha 24))
           (begin
             (set! guardar-valor-en-y y)
             (set! guardar-valor-en-x x)
             (set! y (- y 1))
             (set! x (- x 1))
             (set! bandera2 (vector-ref(vector-ref jaque-blanca  y )x))
             (if (ataque-del-peón-jaque  x y guardar-valor-en-x guardar-valor-en-y bandera2)
                 (begin
                   (set! x guardar-valor-en-x )
                   (set! y guardar-valor-en-y )
                   (set! bandera-jaque (+ bandera-jaque 1))
                   )
                 (void
                  )
                 )
             (set! x guardar-valor-en-x )
             (set! y guardar-valor-en-y )
             (if (and(> 9 (+ x 1))(> (- y 1)0))
                 (begin
                   (set! y (- y 1))
                   (set! x (+ x 1))
                   (set! bandera2 (vector-ref(vector-ref jaque-blanca  y ) x ))
                   (if (ataque-del-peón-jaque  x y guardar-valor-en-x guardar-valor-en-y bandera2)
                       (begin
                         (set! x guardar-valor-en-x )
                         (set! y guardar-valor-en-y )
                         (set! x(+ 1 x))
                         (jaque-blancas x y )
                         (set! bandera-jaque (+ bandera-jaque 1))
                         )
                       (begin
                         (set! x guardar-valor-en-x )
                         (set! y guardar-valor-en-y )
                         (set! x(+ 1 x))
                         (jaque-blancas x y )
                         )
                       )
                   )
                 (begin
                   (set! x(+ 1 x))
                   (jaque-blancas x y )
                   )
                 )
             )
           (if(or(= 25 ficha)(= ficha 32)(= ficha 29)) 
              (begin
                (set! guardar-valor-en-y y)
                (set! guardar-valor-en-x x)
                (set! y(- y 1))
                (set! bandera2 (vector-ref(vector-ref jaque-blanca y )x))
                (if (bloque-torrea-arriba-jaque x y  guardar-valor-en-y bandera2 )
                    (begin
                      (set!  y guardar-valor-en-y )
                      (set! bandera-jaque (+ bandera-jaque 1))
                      )
                    (set! y guardar-valor-en-y )
                    )
                (if(< (+ y 1) 9)
                   (begin
                     (set! y (+ y 1))
                     (set! bandera2(vector-ref(vector-ref jaque-blanca   y)  x))
                     (if (bloque-torrea-abajo-jaque x y  guardar-valor-en-y bandera2)
                         (begin
                           (set!  y guardar-valor-en-y )
                           (set! bandera-jaque (+ bandera-jaque 1))
                           )
                         (set! y guardar-valor-en-y )
                         )
                     )
                   (void)
                   )
                (if(< (+ x 1) 9) 
                   (begin
                     (set! x (+ 1 x))
                     (set! bandera2 (vector-ref(vector-ref jaque-blanca y)  x))
                     (if(bloque-torrea-derecha-jaque x y  guardar-valor-en-x bandera2)
                        (begin
                          (set!  x guardar-valor-en-x)
                          (set! bandera-jaque (+ bandera-jaque 1))
                          )
                        (set! x guardar-valor-en-x )
                        )
                     )
                   (void)
                   )
                (set! x (- x 1))
                (set! bandera2 (vector-ref(vector-ref jaque-blanca y) x))
                (if(bloque-torrea-izquierda-jaque x y guardar-valor-en-x bandera2)
                   (begin
                     (set! bandera-jaque (+ bandera-jaque 1))
                     (set! x guardar-valor-en-x )
                     (if(= ficha 29)
                        (alfil-jaque x y )
                        (begin
                          (set! x(+ x 1))
                          (jaque-blancas x y )
                          )
                        )
                     )
                   (begin
                     (set! x guardar-valor-en-x )
                     (if(= ficha 29)
                        (alfil-jaque x y)
                        (begin
                          (set! x(+ x 1))
                          (jaque-blancas x y )
                          )
                        )
                     )
                   )
                )
              (if(or(= 26 ficha)(= ficha 31))  
                 (begin
                    (set! guardar-valor-en-x x )
                        (set! guardar-valor-en-y y )
                   (if(< 0 (- y 2))
                      (begin
                        (set! x (- x 1) )
                        (set! y (- y 2) )
                        (set! bandera2 (vector-ref(vector-ref jaque-blanca y ) x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(and(< 0 (- y 2))(< (+ x 1) 9))
                      (begin
                        (set! x (+ x 1) )
                        (set! y (- y 2) )
                        (set! bandera2 (vector-ref(vector-ref jaque-blanca  y ) x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(< (+ y 2) 9)
                      (begin
                        (set! x (- x 1) )
                        (set! y (+ y 2) )
                        (set! bandera2 (vector-ref(vector-ref jaque-blanca  y ) x ))
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(and(< (+ y 2) 9)(< (+ x 1) 9))
                      (begin
                        (set! x (+ x 1) )
                        (set! y (+ y 2) )
                        (set! bandera2 (vector-ref(vector-ref jaque-blanca  y )  x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(< (+ x 2) 9)
                      (begin
                        (set! x (+ x 2) )
                        (set! y (- y 1) )
                        (set! bandera2 (vector-ref(vector-ref jaque-blanca  y )  x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(< 0 (- x 2))
                      (begin
                        (set! x (- x 2) )
                        (set! y (- y 1) )
                        (set! bandera2 (vector-ref(vector-ref jaque-blanca  y )  x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(and(< (+ y 1) 9)(< 0 (- x 2)))
                      (begin
                        (set! x (- x 2) )
                        (set! y (+ y 1) )
                        (set! bandera2 (vector-ref(vector-ref jaque-blanca  y )  x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(and(< (+ x 2) 9)(< (+ y 1) 9))
                      (begin
                        (set! x (+ x 2) )
                        (set! y (+ y 1) )
                        (set! bandera2 (vector-ref(vector-ref jaque-blanca  y )  x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             (set! bandera-jaque (+ bandera-jaque 1))
                             (set! x(+ x 1))
                             (jaque-blancas x y )
                             )
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             (set! x(+ x 1))
                             (jaque-blancas x y )
                             )
                           )
                        )
                      (begin
                        (set! x(+ x 1))
                        (jaque-blancas x y )
                        )
                      )
                   )
                 (alfil-jaque  x y  ) 
                 )
              )
           )
        ) 
      (begin
        (if(= 9 y)
           (begin
             (void)
             )
           (begin
             (set!  y guardar-valor-en-y)
             (set!  x guardar-valor-en-x)
             (set! x 1)
             (set! y (+ y 1))
             (jaque-blancas x y )
             )
           )
        )
      )
  )
;-----------------------------------------------------------------------------------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------------------------------------------------------------------------------
(define (jaque-negras x y )
  (if (and(>= x 0)(<= x 8)(>= y 0)(<= y 8))
      (begin
        (set! ficha(vector-ref(vector-ref jaque-negra y)x))
        (if(and(<= 1 ficha)(<= ficha 8))
           (begin
             (set! guardar-valor-en-y y)
             (set! guardar-valor-en-x x)
             (set! y (+ y 1))
             (set! x (- x 1))
             (set! bandera2 (vector-ref(vector-ref jaque-negra  y )x))
             (if (ataque-del-peón-jaque  x y guardar-valor-en-x guardar-valor-en-y bandera2)
                 (begin
                   (set! x guardar-valor-en-x )
                   (set! y guardar-valor-en-y )
                   (set! bandera-jaque (+ bandera-jaque 1))
                   )
                 (void
                  )
                 )
             (set! x guardar-valor-en-x )
             (set! y guardar-valor-en-y )
             (if (and(> 9 (+ x 1))(> (- y 1)0))
                 (begin
                   (set! y (+ y 1))
                   (set! x (+ x 1))
                   (set! bandera2 (vector-ref(vector-ref jaque-negra  y ) x ))
                   (if (ataque-del-peón-jaque  x y guardar-valor-en-x guardar-valor-en-y bandera2)
                       (begin
                         (set! x guardar-valor-en-x )
                         (set! y guardar-valor-en-y )
                         (set! x(+ 1 x))
                         (set! bandera-jaque (+ bandera-jaque 1))
                         (jaque-negras x y )
                         )
                       (begin
                         (set! x guardar-valor-en-x )
                         (set! y guardar-valor-en-y )
                         (set! x(+ 1 x))
                         (jaque-negras x y )
                         )
                       )
                   )
                 (begin
                   (set! x(+ 1 x))
                   (jaque-negras x y )
                   )
                 )
             )
           (if(or(= 9 ficha)(= ficha 16)(= ficha 13)) 
              (begin
                (set! guardar-valor-en-y y)
                (set! guardar-valor-en-x x)
                (set! y(- y 1))
                (set! bandera2 (vector-ref(vector-ref jaque-negra y )x))
                (if (bloque-torrea-arriba-jaque x y  guardar-valor-en-y bandera2 )
                    (begin
                      (set!  y guardar-valor-en-y )
                      (set! bandera-jaque (+ bandera-jaque 1))
                      )
                    (set! y guardar-valor-en-y )
                    )
                (if(< (+ y 1) 9)
                   (begin
                     (set! y (+ y 1))
                     (set! bandera2(vector-ref(vector-ref jaque-negra   y)  x))
                     (if (bloque-torrea-abajo-jaque x y  guardar-valor-en-y bandera2)
                         (begin
                           (set!  y guardar-valor-en-y )
                           (set! bandera-jaque (+ bandera-jaque 1))
                           )
                         (set! y guardar-valor-en-y )
                         )
                     )
                   (void)
                   )
                (if(< (+ x 1) 9) 
                   (begin
                     (set! x (+ 1 x))
                     (set! bandera2 (vector-ref(vector-ref jaque-negra y)  x))
                     (if(bloque-torrea-derecha-jaque x y  guardar-valor-en-x bandera2)
                        (begin
                          (set!  x guardar-valor-en-x)
                          (set! bandera-jaque (+ bandera-jaque 1))
                          )
                        (set! x guardar-valor-en-x )
                        )
                     )
                   (void)
                   )
                (set! x (- x 1))
                (set! bandera2 (vector-ref(vector-ref jaque-negra y) x))
                (if(bloque-torrea-izquierda-jaque x y guardar-valor-en-x bandera2)
                   (begin
                     (set! bandera-jaque (+ bandera-jaque 1))
                     (set! x guardar-valor-en-x )
                     (if(= ficha 13)
                       (alfil-jaque-negra  x y  ) 
                        (begin
                          (set! x(+ x 1))
                          (jaque-negras x y )
                          )
                        )
                     )
                   (begin
                     (set! x guardar-valor-en-x )
                     (if(= ficha 13)
                       (alfil-jaque-negra  x y  ) 
                        (begin
                          (set! x(+ x 1))
                          (jaque-negras x y )
                          )
                        )
                     )
                   )
                )
              (if(or(= 10 ficha)(= ficha 15))  
                 (begin
                   (if(< 0 (- y 2))
                      (begin
                        (set! guardar-valor-en-x x )
                        (set! guardar-valor-en-y y )
                        (set! x (- x 1) )
                        (set! y (- y 2) )
                        (set! bandera2 (vector-ref(vector-ref jaque-negra y ) x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                             (begin
                              (set!  x  guardar-valor-en-x)
                        (set!  y guardar-valor-en-y)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           )
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(and(< 0 (- y 2))(< (+ x 1) 9))
                      (begin
                        (set! guardar-valor-en-x x )
                        (set! guardar-valor-en-y y )
                        (set! x (+ x 1) )
                        (set! y (- y 2) )
                        (set! bandera2 (vector-ref(vector-ref jaque-negra  y ) x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (begin
                              (set!  x  guardar-valor-en-x)
                        (set!  y guardar-valor-en-y)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           )
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void) 
                      )
                   (if(< (+ y 2) 9)
                      (begin
                        (set! guardar-valor-en-x x )
                        (set! guardar-valor-en-y y )
                        (set! x (- x 1) )
                        (set! y (+ y 2) )
                        (set! bandera2 (vector-ref(vector-ref jaque-negra  y ) x ))
                        (if(bloque-de-caballo-jaque x y bandera2)
                             (begin
                              (set!  x  guardar-valor-en-x)
                        (set!  y guardar-valor-en-y)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           )
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(and(< (+ y 2) 9)(< (+ x 1) 9))
                      (begin
                        (set! guardar-valor-en-x x )
                        (set! guardar-valor-en-y y )
                        (set! x (+ x 1) )
                        (set! y (+ y 2) )
                        (set! bandera2 (vector-ref(vector-ref jaque-negra  y )  x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                             (begin
                              (set!  x  guardar-valor-en-x)
                        (set!  y guardar-valor-en-y)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           )
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(< (+ x 2) 9)
                      (begin
                        (set! guardar-valor-en-x x )
                        (set! guardar-valor-en-y y )
                        (set! x (+ x 2) )
                        (set! y (- y 1) )
                        (set! bandera2 (vector-ref(vector-ref jaque-negra  y )  x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                            (begin
                              (set!  x  guardar-valor-en-x)
                        (set!  y guardar-valor-en-y)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           )
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(< 0 (- x 2))
                      (begin
                        (set! guardar-valor-en-x x )
                        (set! guardar-valor-en-y y )
                        (set! x (- x 2) )
                        (set! y (- y 1) )
                        (set! bandera2 (vector-ref(vector-ref jaque-negra  y )  x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                             (begin
                              (set!  x  guardar-valor-en-x)
                        (set!  y guardar-valor-en-y)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           )
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(and(< (+ y 1) 9)(< 0 (- x 2)))
                      (begin
                        (set! guardar-valor-en-x x )
                        (set! guardar-valor-en-y y )
                        (set! x (- x 2) )
                        (set! y (+ y 1) )
                        (set! bandera2 (vector-ref(vector-ref jaque-negra  y )  x))
                        (if(bloque-de-caballo-jaque x y bandera2)
                            (begin
                              (set!  x  guardar-valor-en-x)
                        (set!  y guardar-valor-en-y)
                           (set! bandera-jaque (+ bandera-jaque 1))
                           )
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             )
                           )
                        )
                      (void)
                      )
                   (if(and(< (+ x 2) 9)(< (+ y 1) 9))
                      (begin
                        (set! guardar-valor-en-x x )
                        (set! guardar-valor-en-y y )
                        (set! x (+ x 2) )
                        (set! y (+ y 1) )
                        (set! bandera2 (vector-ref(vector-ref jaque-negra  y )  x)) 
                        (if(bloque-de-caballo-jaque x y bandera2)
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             (set! bandera-jaque (+ bandera-jaque 1))
                             (set! x(+ x 1))
                             (jaque-negras x y )
                             )
                           (begin
                             (set! x guardar-valor-en-x )
                             (set! y guardar-valor-en-y )
                             (set! x(+ x 1))
                             (jaque-negras x y )
                             )
                           )
                        )
                      (begin
                        (set! x(+ x 1))
                        (jaque-negras x y )
                        )
                      )
                   )
                 (alfil-jaque-negra  x y  ) 
                 )
              )
           )
        ) 
      (begin
        (if(= 9 y)
           (begin
             (void)
             )
           (begin
             (set!  y guardar-valor-en-y)
             (set!  x guardar-valor-en-x)
             (set! x 1)
             (set! y (+ y 1))
             (jaque-negras x y )
             )
           )
        )
      )
  )
(define (imprimir-jaque-blancas x y)
  (if(> 9 y)
     (if(> 9 x)
        (begin
          (if(and(>= (vector-ref(vector-ref jaque-blanca y)x) 0)(>= 9(vector-ref(vector-ref jaque-blanca y)x)))
             (begin
               (display " ")
               (display(vector-ref(vector-ref jaque-blanca y)x))
               (display "|")
               (set! x (+ x 1))
               (imprimir-jaque-blancas  x y)
               )
             (begin
               (display(vector-ref(vector-ref jaque-blanca y)x))
               (display "|")
               (set! x (+ x 1))
               (imprimir-jaque-blancas  x y)
               )
             )
          )
        (begin
          (newline)
          (set! x 1)
          (set! y (+ y 1))
          (imprimir-jaque-blancas x y)
          )
        )
     (newline)
     )
  )
(define (imprimir-jaque-negras x y)
  (if(> 9 y)
     (if(> 9 x)
        (begin
          (if(and(>= (vector-ref(vector-ref jaque-negra y)x) 0)(>= 9(vector-ref(vector-ref jaque-negra y)x)))
             (begin
               (display " ")
               (display(vector-ref(vector-ref jaque-negra y)x))
               (display "|")
               (set! x (+ x 1))
               (imprimir-jaque-negras x y)
               )
             (begin
               (display(vector-ref(vector-ref jaque-negra y)x))
               (display "|")
               (set! x (+ x 1))
               (imprimir-jaque-negras x y)
               )
             )
          )
        (begin
          (newline)
          (set! x 1)
          (set! y (+ y 1))
          (imprimir-jaque-negras x y)
          )
        )
     (void)
     )
  )

(juego)

